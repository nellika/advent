<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://fonts.googleapis.com/css?family=Fredericka+the+Great|Pacifico&display=swap&subset=cyrillic,cyrillic-ext,latin-ext,vietnamese" rel="stylesheet">
    <title>Adventi naptár</title>
    <link rel="stylesheet" href="style.css">
    <script src="vue.min.js"></script>
</head>
<body>
    <main id='cal-container'>
        <h1 id="cal-title">Adventi kalendárium</h1>
        <section id="adv-cal">
            <article @click="toggleOpened" v-for='(word, index) in words' v-bind:class="[index == words.length-1 ? 'word-of-today day-container' : 'day-container']">
                <h2 class="day-header no-highlight">
                    <span>{{index + 1}}</span>
                    <img v-bind:src="getDecorImg(index)" class="decoration">
                </h2>
                <p class="word-of-the-day no-highlight"><span>{{word}}</span></p>
            </article>
            <article @click="toggleOpened" class="day-container no-word" v-if="words.length != 24">
                <h2 class="day-header no-highlight">
                    <span>{{words.length + 1}}</span>
                </h2>
                <p class="word-of-the-day no-highlight">
                    <img id="loading-gif" src="decor/loading.gif" alt="Christmas is loading">
                </p>
            </article>
        </section>
    </main>
<script>
    const app = new Vue({
        el: '#adv-cal',
        data: {
            words: []
        },
        created(){
            fetch('/api/words')
                .then(response => response.json())
                .then(json => {
                    this.words = json
                })
        },
        methods: {
            toggleOpened: function(e){
                let elChild;
                
                if(e.target.tagName.toUpperCase() == 'H2'){
                    elChild = e.path[1];        
                } else {
                    elChild = e.path[2];
                }
                
                elChild.classList.toggle('opened'); 
            },
            getDecorImg : function(index) {
                return `decor/${index%7}.svg`;
            }
        }
    })
</script>
</body>
</html>